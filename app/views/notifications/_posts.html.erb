<% if @posts.present? %>
  <% for post in @posts.compact %>
    <div id="post_<%= post.id %>">
      <div style="float:left;clear:both;"><%= post_picture(post) %></div>
      <div class="post" style="border-bottom-color: #E8E8E8;border-bottom-style: solid;border-bottom-width: 1px;height: auto;">
        <h5 class="post_name"><%= link_to post.user.fullname,profile_path(post.user), :style => 'color:black;font-weight:bold;' %></h5>
        <div class="post_at">&nbsp<%= post.user.username %></div>
        <div class="post_time"><%= time_ago_in_words(post.created_at) %></div>
        <div class="post_text">
          <%= User.find_by_username(post.body.split(" ")[0]).present? ? ((link_to post.body.split(" ")[0], profile_path(post.receiver))+' '+post.body.slice(post.body.split(" ")[0].length..post.body.length)) : post.body.slice(0..300) %><br />
          <% if post.body > post.body.slice(0..300) %>
            <%= link_to_function "Read More", "", :id => "expand_#{post.id}" %>
            <%= link_to_function "Hide", "", :id => "unexpand_#{post.id}", :style => 'display:none;' %>
            &nbsp&nbsp
          <% end %>
          <% if post.document.present? %>
            <%= link_to image_tag(post.document.url(:original),:width => '50px;', :height => '50px;'), post.document.url %>
          <% end %>
        </div>
        <div class="action_row">
          <div id="expa_<%= post.id %>"  style="display:none;">
            <%= post.body %>
          </div>
          &nbsp&nbsp
          <%= link_to image_tag("/assets/reply_icon.png", :width => '10px', :height => '10px')+'Reply', reply_user_post_path(current_user,post) %>
          &nbsp&nbsp
          <% if !post.favorite.present? || !current_user.favorite_for(post).present? %>
            <%= link_to image_tag("/assets/favorite_icon.png", :width => '10px', :height => '10px')+'Favorite',favourite_user_posts_path(post.id),:remote => true,:method => 'post' %>
          <% elsif post.favorite.status == true %>
            <%= link_to image_tag("/assets/favorite_icon.png", :width => '10px', :height => '10px')+'Favorited',update_favourite_user_posts_path(post.id),:remote => true,:method => 'put', :style => 'color: #FF9B00;' %>
          <%elsif post.favorite.status == false%>
            <%= link_to image_tag("/assets/favorite_icon.png", :width => '10px', :height => '10px')+'Favorite',update_mark_favourite_user_posts_path(post.id),:remote => true,:method => 'put' %>
          <% end %>
          <div id="bid-info_<%= post.id %>"></div>
          <div id="expa_<%= post.id %>"  style="display:none;">
            <%= post.created_at.strftime("%Y-%m-%d %H:%M:%S") %><br />
            <b><%= post.user.tweets.where("reply IS NULL").count %></b>&nbsp POSTS&nbsp&nbsp
            <b><%= post.user.tweets.where("reply IS NOT NULL").count %></b>&nbsp REPLIES
          </div>
          <script>
            $("#expand_<%= post.id %>").click(function(){
              $("#unexpand_<%= post.id %>").show();
              $("#expa_<%= post.id %>").show();
              $("#expand_<%= post.id %>").hide();
            });

            $("#unexpand_<%= post.id %>").click(function(){
              $("#expand_<%= post.id %>").show();
              $("#expa_<%= post.id %>").hide();
              $("#unexpand_<%= post.id %>").hide();
            });
          </script>
        </div>
      </div>
    </div>
  <% end %>
<% else %>
  <span style="color: red;font-size: 15px;left: 310px;position: relative;top: -15px;">No Posts.</span>
<% end %>
<% if @posts.total_pages > @posts.current_page %>
  <div id="more_posts_link">
    <input type="hidden" value="<%= @posts.current_page+1 %>" id="posts_page" />
  </div>
<% end %>
<div id='ajax' style='z-index:1000000;width:500px;height:120px;display: none;'>
  <div style="float:left;clear:both;">
    <div class="post" style="height: 72px;">
      <img alt=""  src="/assets/loader.gif" id = "ajax-loader" /><br />
    </div>
  </div>
</div>